<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SLIDER</title>
    <style>
        #slider{
            position: relative;
            margin: auto;
            top: 0;
            left: 0;
            right: 0;
            width: 800px;
            height: 300px;
            border: solid black;
        }
        #botaoIr {
            background-color: rgb(0,0,0, 0.40);
            height: 40%;
            border: none;
            color: rgb(255,255,255, 0.40);
            position: absolute;
            top: 28%;
            right: 0;
            cursor: pointer;
        }
        #botaoVoltar {
            background-color: rgb(0,0,0, 0.40);
            height: 40%;
            border: none;
            color: rgb(255,255,255, 0.40);
            position: absolute;
            top: 28%;
            left: 0;
            cursor: pointer;
        }
        #barra {
            height: 10px;
            border: 1px solid white;
            border-radius: 5px 5px 5px 5px;
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
        }
        #loading {
            background-color: rgba(255, 255, 255, 0.405);
            border-radius: 5px 5px 5px 5px;
            height: 10px;
            width: 0%;
            position: absolute;
            top: 0;
            bottom: 0;
            margin: auto;
           
        }
    </style>
    <script>
        var imgs =[];
        var slider;
        var imagemAtual;
        var maxImagem;
        var tempoTroca;
        var load;
        var vload;

        function povoarArrayImagens() {
            var s=1
            for (var i=0;i<5;i++) {
                imgs[i]=new Image();
                imgs[i].src="/imagens/s"+s+".png"; 
                s++;
            }
        }

        function carregarImg(img) {
            slider = document.getElementById("slider");
            slider.style.backgroundImage="url('"+imgs[img].src+"')";
        }

        function iniciar() {
            povoarArrayImagens();
            imagemAtual = 0;
            maxImagem = imgs.length-1;
            tempoTroca=0;
            carregarImg(imagemAtual);
            anima();
        }

        function trocarImagem(dir) {
            tempoTroca = 0;
            imagemAtual+=dir;
            if (imagemAtual > maxImagem) {
                imagemAtual = 0;
            } else if (imagemAtual < 0) {
                imagemAtual = maxImagem;
            }
            carregarImg(imagemAtual);
        }
        function anima() {
            tempoTroca++;
            if (tempoTroca >= 300) {
                tempoTroca = 0;
                trocarImagem(1);
            }
            load = tempoTroca/3;
            document.getElementById('loading').style.width=load+'%';
            window.requestAnimationFrame(anima);
            console.log(tempoTroca);
        }
        
        window.addEventListener("load", iniciar);
    </script>
</head>
<body>
    <div id="slider">
        <button id="botaoIr" onclick="trocarImagem(1)">></button>
        <button id="botaoVoltar" onclick="trocarImagem(-1)"><</button>
        <div id="barra">
            <div id="loading"></div>
        </div>
    </div>
</body>
</html>